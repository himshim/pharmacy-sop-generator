<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pharmacy SOP Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Materialize -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Alpine -->
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

  <link rel="stylesheet" href="styles.css">
</head>

<body class="grey lighten-4" x-data="sopApp()" x-init="init()">

<nav class="blue darken-2 no-print">
  <div class="nav-wrapper container">
    <span class="brand-logo">Pharmacy SOP Generator</span>
  </div>
</nav>

<div class="container section no-print">

  <!-- FORMAT -->
  <div class="card">
    <div class="card-content">
      <span class="card-title">SOP Format</span>
      <a class="btn blue" @click="toggleFormat()">Switch Format</a>
    </div>
  </div>

  <div class="row">
    <div class="col s12 m6">

      <!-- INSTITUTE -->
      <div class="card">
        <div class="card-content">
          <span class="card-title">Institute</span>
          <input placeholder="Institute Name" x-model="institute.name">
          <input placeholder="Department" x-model="institute.dept">
        </div>
      </div>

      <!-- SOP SELECTION -->
      <div class="card">
        <div class="card-content">
          <span class="card-title">SOP Selection</span>

          <!-- DEPARTMENT SELECT -->
          <div class="input-field">
            <select x-model="department" @change="loadDepartment()">
              <template x-for="d in departments" :key="d.key">
                <option :value="d.key" x-text="d.name"></option>
              </template>
            </select>
            <label>Select Department</label>
          </div>

          <!-- SOP SELECT -->
          <div class="input-field">
            <select x-model="sopKey" @change="loadSOP(sopKey)">
              <template x-for="sop in sopList" :key="sop.key">
                <option :value="sop.key" x-text="sop.name"></option>
              </template>
            </select>
            <label>Select SOP</label>
          </div>
        </div>
      </div>

    </div>

    <div class="col s12 m6">
      <div class="card center-align">
        <div class="card-content">
          <button class="btn green" onclick="window.print()">Print SOP</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- PREVIEW (unchanged, your existing preview stays here) -->
<div id="print-zone">
  <div id="preview">
    <!-- your existing preview templates -->
  </div>
</div>

<script src="js/alpineApp.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    M.FormSelect.init(document.querySelectorAll('select'));
  });
</script>

</body>
</html>